---
layout: post
title:  "Docker"
subtitle: "一种容器虚拟化技术"
date:   2018-07-21 20:25:12 -0401
background: '/img/posts/docker/docker.png'
categories: Tech
---
## 1 概念
docker是一种容器技术，便于进行快速、轻便的进行部署，跟传统的虚拟机相比，启动更快，性能更高：
![docker与传统虚拟机对比](/img/posts/docker/docker_comparison.png)

#### 1.1 镜像 Image
docker 镜像是一个特殊的文件系统，采用分层存储进行构建，既提供了容器运行时的程序、库、资源、配置等文件，也包含了一些为运行时准备的一些配置参数（如匿名卷、环境变量、用户等）。

#### 1.2 容器 Container
容器是由镜像创建的实例化进程，它与镜像的关系，类似于在面向对象程序设计中的类与实例的关系一样，容器可以被创建、启动、停止、删除、暂停等。而且每个容器有自己独立的root文件系统、网络配置、进程空间以及童虎ID空间，需要注意的是容器存储层是虚拟化的，当容器结束时，容器存储层也会消亡.因此，如果想要进行文件的存储，应该使用数据卷(volume),数据卷的生存周期独立于容器，类似于挂载，数据卷独立于容器存在。

#### 1.3 仓库
仓库进行镜像存储和分发，类似于Github仓库。仓库内的镜像命名格式为```<仓库名>:<标签>```，如果不给出标签，将以```latest```作为默认标签。


## 2 镜像构建
通过Dockerfile进行镜像的定制，```Dockerfile```是一个文本文件，包含镜像定制指令，每一条指令构建一层。

#### 2.1 FROM
指定基础镜像，```FROM```指定基础镜像，为必备指令，也是第一条指令，基础镜像可以从官方镜像中拉取。

#### 2.2 RUN
```RUN```用来执行命令行命令，为定制镜像时最常用的指令之一，格式一般为``` RUN ["cmd", "param1", "param2"...]``` ```cmd```一般为shell命令。egg.
``` 
FROM debian:jessie

RUN apt-get update

RUN apt-get install -y gcc libc6-dev make
...

```

#### 2.3 COPY
复制命令，格式为```COPY <source_path> <destination>```,类似于shell中的```cp```命令

#### 2.4 ADD
更高级的复制命令
- 如果<source>是一个URL，会将文件下载下来放入目标位置
- 如果<source>是压缩文件，会将文件解压缩到目标位置

#### （待续）

## docker-compose
